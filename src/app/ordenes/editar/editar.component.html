<div class="p-6" *ngIf="!loading; else cargando">
  <h1 class="text-2xl font-bold mb-4">
    {{ mode === 'attend' ? 'Atender Orden' : 'Editar Orden' }}
  </h1>

  <p *ngIf="errorMessage" class="text-red-600 mb-4">{{ errorMessage }}</p>

  <!-- MODO ATENDER: mostramos solo campos de cierre -->
  <div *ngIf="mode === 'attend'; else editForm" class="space-y-4 max-w-xl">
    <div>
      <label class="block text-sm font-medium">Técnico asignado</label>
      <input [(ngModel)]="form.assignedTechnician" type="text" class="w-full border p-2 rounded" />
    </div>

    <div>
      <label class="block text-sm font-medium">Valor mano de obra</label>
      <input [(ngModel)]="form.laborValue" type="number" min="0" class="w-full border p-2 rounded" />
    </div>

    <div>
      <label class="block text-sm font-medium">Fecha del servicio</label>
      <input [(ngModel)]="form.dateService" type="datetime-local" class="w-full border p-2 rounded" />
    </div>

    <div>
      <label class="block text-sm font-medium">Estado</label>
      <select [(ngModel)]="form.status" class="w-full border p-2 rounded">
        <option value="FINALIZED">FINALIZED</option>
        <option value="PENDING">PENDING</option>
      </select>
    </div>

    <div class="flex gap-3 mt-4">
      <button (click)="guardar()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
        Guardar
      </button>
      <button (click)="cancelar()" class="bg-gray-200 px-4 py-2 rounded hover:bg-gray-300">
        Cancelar
      </button>
    </div>
  </div>

  <!-- MODO EDIT (formulario completo) -->
  <ng-template #editForm>
    <div class="space-y-4 max-w-xl">
      <div>
        <label class="block text-sm font-medium">Diagnóstico</label>
        <textarea [(ngModel)]="form.diagnostic" rows="3" class="w-full border p-2 rounded"></textarea>
      </div>

      <div>
        <label class="block text-sm font-medium">Técnico asignado</label>
        <input [(ngModel)]="form.assignedTechnician" type="text" class="w-full border p-2 rounded" />
      </div>

      <div>
        <label class="block text-sm font-medium">Valor mano de obra</label>
        <input [(ngModel)]="form.laborValue" type="number" min="0" class="w-full border p-2 rounded" />
      </div>

      <div>
        <label class="block text-sm font-medium">Fecha del servicio</label>
        <input [(ngModel)]="form.dateService" type="datetime-local" class="w-full border p-2 rounded" />
      </div>

      <div>
        <label class="block text-sm font-medium">Estado</label>
        <select [(ngModel)]="form.status" class="w-full border p-2 rounded">
          <option value="PENDING">PENDING</option>
          <option value="FINALIZED">FINALIZED</option>
        </select>
      </div>

      <div class="flex gap-3 mt-4">
        <button (click)="guardar()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
          Guardar
        </button>
        <button (click)="cancelar()" class="bg-gray-200 px-4 py-2 rounded hover:bg-gray-300">
          Cancelar
        </button>
      </div>
    </div>
  </ng-template>
</div>

<ng-template #cargando>
  <div class="p-6">Cargando...</div>
</ng-template>
